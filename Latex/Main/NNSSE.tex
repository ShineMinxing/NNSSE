%Version 3 October 2023
% See section 11 of the User Manual for version history
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%\documentclass[referee,sn-basic]{sn-jnl}% referee option is meant for double line spacing

%%=======================================================%%
%% to print line numbers in the margin use lineno option %%
%%=======================================================%%

%%\documentclass[lineno,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style

%%======================================================%%
%% to compile with pdflatex/xelatex use pdflatex option %%
%%======================================================%%

%%\documentclass[pdflatex,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style


%%Note: the following reference styles support Namedate and Numbered referencing. By default the style follows the most common style. To switch between the options you can add or remove �Numbered� in the optional parenthesis. 
%%The option is available for: sn-basic.bst, sn-vancouver.bst, sn-chicago.bst%  
 
\documentclass[sn-nature]{sn-jnl}% Style for submissions to Nature Portfolio journals
% \documentclass[sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style
% \documentclass[sn-mathphys-num]{sn-jnl}% Math and Physical Sciences Numbered Reference Style
%%\documentclass[sn-mathphys-ay]{sn-jnl}% Math and Physical Sciences Author Year Reference Style
%%\documentclass[sn-aps]{sn-jnl}% American Physical Society (APS) Reference Style
%%\documentclass[sn-vancouver,Numbered]{sn-jnl}% Vancouver Reference Style
%%\documentclass[sn-apa]{sn-jnl}% APA Reference Style 
%%\documentclass[sn-chicago]{sn-jnl}% Chicago-based Humanities Reference Style

%%%% Standard Packages
%%<additional latex packages if required can be included here>

\usepackage{graphicx}%
\usepackage{multirow}%
\usepackage{amsmath,amssymb,amsfonts}%
\usepackage{amsthm}%
\usepackage{mathrsfs}%
\usepackage[title]{appendix}%
\usepackage{xcolor}%
\usepackage{textcomp}%
\usepackage{manyfoot}%
\usepackage{booktabs}%
\usepackage{algorithm}%
\usepackage{algorithmicx}%
\usepackage{algpseudocode}%
\usepackage{listings}%
%%%%

%%%%%=============================================================================%%%%
%%%%  Remarks: This template is provided to aid authors with the preparation
%%%%  of original research articles intended for submission to journals published 
%%%%  by Springer Nature. The guidance has been prepared in partnership with 
%%%%  production teams to conform to Springer Nature technical requirements. 
%%%%  Editorial and presentation requirements differ among journal portfolios and 
%%%%  research disciplines. You may find sections in this template are irrelevant 
%%%%  to your work and are empowered to omit any such section if allowed by the 
%%%%  journal you intend to submit to. The submission guidelines and policies 
%%%%  of the journal take precedence. A detailed User Manual is available in the 
%%%%  template package for technical guidance.
%%%%%=============================================================================%%%%

%% as per the requirement new theorem styles can be included as shown below
\theoremstyle{thmstyleone}%
\newtheorem{theorem}{Theorem}%  meant for continuous numbers
%%\newtheorem{theorem}{Theorem}[section]% meant for sectionwise numbers
%% optional argument [theorem] produces theorem numbering sequence instead of independent numbers for Proposition
\newtheorem{proposition}[theorem]{Proposition}% 
%%\newtheorem{proposition}{Proposition}% to get separate numbers for theorem and proposition etc.

\theoremstyle{thmstyletwo}%
\newtheorem{example}{Example}%
\newtheorem{remark}{Remark}%

\theoremstyle{thmstylethree}%
\newtheorem{definition}{Definition}%

\raggedbottom
%%\unnumbered% uncomment this for unnumbered level heads

\begin{document}

\title[Article Title]{Neural Network State-Space Estimators}

%%=============================================================%%
%% GivenName	-> \fnm{Joergen W.}
%% Particle	-> \spfx{van der} -> surname prefix
%% FamilyName	-> \sur{Ploeg}
%% Suffix	-> \sfx{IV}
%% \author*[1,2]{\fnm{Joergen W.} \spfx{van der} \sur{Ploeg} 
%%  \sfx{IV}}\email{iauthor@gmail.com}
%%=============================================================%%

\author[1,2,3,4]{\fnm{Minxing} \sur{Sun}}\email{iauthor@gmail.com}

\author[1,2,3]{\fnm{Li} \sur{Miao}}\email{iiauthor@gmail.com}

\author[1,2,3,4]{\fnm{Qingyu} \sur{Shen}}\email{iiiauthor@gmail.com}

\author*[1,2,3]{\fnm{Yao} \sur{Mao}}\email{iiiauthor@gmail.com}

\author[1,2,3]{\fnm{Qiliang} \sur{Bao}}\email{iiiauthor@gmail.com}

\affil*[1]{\orgdiv{National Key Laboratory of Optical Field Manipulation Science and Technology}, \orgname{Chinese Academy of Science}, \orgaddress{\city{Chengdu}, \postcode{610209}, \state{Sichuan}, \country{China}}}

\affil[2]{\orgdiv{Key Laboratory of Optical Engineering}, \orgname{Chinese Academy of Science}, \orgaddress{\city{Chengdu}, \postcode{610209}, \state{Sichuan}, \country{China}}}

\affil[3]{\orgdiv{Institute of Optics and Electronics}, \orgname{Chinese Academy of Sciences}, \orgaddress{\city{Chengdu}, \postcode{610209}, \state{Sichuan}, \country{China}}}

\affil[4]{\orgdiv{School of Electronic, Electrical and Communication Engineering}, \orgname{University of Chinese Academy of Sciences}, \orgaddress{\city{Beijing}, \postcode{101408}, \country{China}}}

%%==================================%%
%% Sample for unstructured abstract %%
%%==================================%%

\abstract{
Classical state estimation algorithms rely on predefined state-space models, complicating mathematical modeling and limiting applicability when those models change. Artificial neural network–based estimators offer an alternative, but they seldom incorporate classical estimation techniques intrinsically and depend heavily on pre-collected training data. To address these challenges, we introduce a state-space model in which the input-layer nodes and all weight parameters are treated as estimated states, effectively simulating a neural network. We implement this nonlinear model using the canonical representatives of three estimator classes—the Extended Kalman Filter, the Unscented Kalman Filter, and the Particle Filter—to validate its generality. The model’s accuracy is then compared against seven neural network–based methods across three test scenarios. Results show that our neural network state-space estimators combine robust learning capability with higher accuracy than traditional model-based methods, while matching the performance of pre-trained neural network approaches.}

\keywords{Kalman estimator, Neural network, Learning capability, Adaptability}

\maketitle

\section{Introduction}\label{sec1}

State estimation algorithms are extensively utilized across various engineering disciplines. For example, in electro-optical tracking systems, they are essential for mitigating optical path disturbances caused by atmospheric turbulence, compensating for delays in hardware and image processing pipelines, and filtering out signal noise generated by sensors and target detection mechanisms. The fundamental principle of these algorithms comprises three stages: predicting the next state using the current estimate and the state‐space model, predicting the corresponding observation via the observation equation, and correcting the state estimate based on the deviations between the actual observation and its prediction.

Estimators can be categorized based on how they establish the relationship between observation deviations and state deviations. One category comprises methods such as the Extended Kalman Filter (EKF), which computes partial derivatives from the state-space model. The primary limitation of EKF is the complexity involved in deriving analytical solutions for these partial derivatives, particularly in highly nonlinear models. Another category includes the Unscented Kalman Filter (UKF), which approximates the state distribution by assigning predefined deviations to each estimated state and evaluating the resulting variations in observations. However, UKF faces challenges in accurately capturing the relationships between coupled estimated states and observations. The third category is represented by Particle Filtering (PF), which introduces random perturbations to the estimated states and assesses the resulting observation variations. While PF is better suited for handling nonlinearities, its main drawback is the high computational cost associated with the large number of particles required, which can impede real-time performance.

All three estimation methods rely on predefined state-space models, and even the robust estimators designed to mitigate model inaccuracies can only compensate for a limited range of errors. In practical applications, defining an accurate state-space model for the target system is often inherently challenging, particularly when tracking non-cooperative targets.

The rapid advancement and widespread adoption of artificial neural network (ANN) methodologies have profoundly impacted time-domain signal processing, enabling significant breakthroughs in estimation and prediction tasks. Recurrent Neural Networks (RNNs), introduced by Hopfield (1982), were enhanced by Rumelhart, Hinton, and Williams (1986) with the backpropagation algorithm, facilitating more efficient training. Subsequent improvements by Jordan (1986) and Elman (1990) incorporated feedback loops, enhancing the ability to model temporal dependencies. However, RNNs struggled with vanishing and exploding gradients, challenges addressed by Hochreiter (1997) with Long Short-Term Memory (LSTM) networks, and further refined by Schmidhuber (1999) through the addition of forget gates. Gated Recurrent Units (GRUs), proposed by Kyunghyun (2014) and validated by Junyoung (2014), offered a simplified yet effective alternative to LSTMs. Convolutional Neural Networks (CNNs), initially developed by LeCun (1989) for handwritten digit recognition, have been extended to Recurrent Convolutional Neural Networks (Ming, 2015) to capture spatial and temporal dependencies, significantly improving prediction accuracy in applications such as vehicle and human trajectory forecasting (Xiaoyu, 2020; Dapeng, 2020, 2021). Temporal Convolutional Networks (TCNs), introduced by Colin (2018), utilize pooling and upsampling to capture long-term motion patterns, enhancing capabilities in action segmentation and detection (Chen, 2020; Kaiyu, 2022). Neural Ordinary Differential Equations (NeuralODEs), proposed by Ricky (2018), represent neural network layers through differential equations, facilitating deeper and more efficient networks for tasks like robotic path planning and travel time estimation (Suhan, 2022; Yijun, 2023). Transformer architectures, introduced by Ashish (2017), leverage self-attention mechanisms to model long-term dependencies while reducing computational complexity. Their applications span maneuvering target tracking, autonomous vehicle trajectory prediction, and 3D human pose estimation (Yushu, 2017; Divya, 2022; Jihua, 2024). 

Traditional estimation algorithms have also been integrated into neural networks to optimize training processes. Early efforts by Singhal (1988), Puskorius (1994), and Pérez-Ortiz (2003) applied Extended Kalman Filters (EKF) to train multilayer perceptrons and recurrent neural networks (RNNs), enhancing training efficiency. More recent integrations of Unscented Kalman Filters (UKF) and Particle Filters (PF) have improved the training of feedforward and recurrent networks in applications such as voice classification and evapotranspiration estimation (Zaqiatud, 2017; Nazari, 2020). However, in these studies, estimation algorithms primarily treated the backpropagation algorithm as state-space equations, serving an auxiliary role rather than being the primary mechanism for state estimation. Consequently, the effectiveness of estimation algorithms remains limited and warrants further enhancement.

To address these limitations, our proposed algorithm introduces a novel state-space model that treats input layer nodes and all weight parameters as estimated states, effectively simulating a neural network within a state estimation framework. The main contributions of this work are as follows:

\begin{itemize}
  
\item Neural Network State-Space Equation: We propose a state-space equation that simulates a neural network, enabling real-time learning and pretraining. The estimation algorithms can be tailored by adjusting the input layer length and prediction steps to meet engineering requirements.

\item Model Generality: The versatility of the proposed state-space equation is validated through the implementation of three representative estimation algorithms—EKF, UKF, and PF—demonstrating its broad applicability.

\item Simulation of Diverse Architectures: The state-space equation is applied to neural networks with varying numbers of hidden layers and different configurations regarding the use of activation functions.

\item Comparative Performance Evaluation: We compare the estimation performance of our state-space-based algorithms with various neural network architectures, including RNN, LSTM, GRU, TCN, Neural Ordinary Differential Equation(NeuralODE), and Transformer.

\item Comprehensive Testing: Extensive tests were conducted on generated sine trajectories, a laboratory dual-reflection mirror platform, and actual unmanned aerial vehicle (UAV) trajectory data, demonstrating the robustness and effectiveness of our proposed method.

\end{itemize}

\section{Problem Statement}\label{sec2}
\noindent
In many real–world tracking problems, the target is non-cooperative, so an accurate motion model cannot be specified a priori.  A common expedient is the constant-acceleration state–space model in~\eqref{1_4}, where only position can be observed while velocity and acceleration remain hidden:  
\begin{equation}
\label{1_4}
\begin{aligned}
x_{i+1} &= 
\begin{bmatrix}
1 & T & \tfrac{T^{2}}{2}\\[2pt]
0 & 1 & T\\
0 & 0 & 1
\end{bmatrix} x_i \;+\;
\begin{bmatrix}
1&0&0\\
0&1&0\\
0&0&1
\end{bmatrix} u_i,\\[4pt]
z_i &= 
\begin{bmatrix}
1&0&0
\end{bmatrix} x_i + v_i .
\end{aligned}
\end{equation}

\noindent

\medskip
The state vector \(x_i=[p_i,v_i,a_i]^{\mathsf T}\) stacks position, velocity and acceleration at instant~\(i\). \(T\) is the time interval between successive estimates. The process noise \(u_i\) absorbs modelling errors and environmental perturbations, and the measurement noise \(v_i\) reflects sensor inaccuracies; both are assumed zero-mean Gaussian.  Their second-order statistics together with the initial error covariance \(\Pi_{0|0}\) are summarised in~\eqref{1_2}, in which \(\delta_{ij}\) denotes the Kronecker delta:  

\begin{equation}
\label{1_2}
E\!\left(
\begin{bmatrix}x_0\\u_i\\v_i\end{bmatrix}
\begin{bmatrix}x_0\\u_j\\v_j\end{bmatrix}^{\!\mathsf T}
\right)=
\begin{bmatrix}
\Pi_{0|0} & 0 & 0\\
0 & Q\,\delta_{ij} & 0\\
0 & 0 & R\,\delta_{ij}
\end{bmatrix}.
\end{equation}

\noindent

\medskip
Because the true motion can be highly nonlinear, model~\eqref{1_4} rarely yields the desired predictive accuracy.  Although the Kalman filter provides on-line estimates of \(v_i\) and \(a_i\), they are ultimately reconstructed from past position measurements.  With scalar gains \(w_{v1},w_{v2},w_{a1},w_{a2}\) from calculated Kalman gain, the recursive updates read

\begin{equation}
\label{1_6}
\begin{aligned}
{v_i} =& {w_{v1}}\frac{{{p_i} - {p_{i - 1}}}}{T} + {w_{v2}}{v_{i - 1}}\\
    =& {w_{v1}}\frac{{{p_i} - {p_{i - 1}}}}{T} + {w_{v1}}{w_{v2}}\frac{{{p_{i - 1}} - {p_{i - 2}}}}{T} + {w_{v1}}w_{v2}^{\rm{2}}\frac{{{p_{i - {\rm{2}}}} - {p_{i - {\rm{3}}}}}}{T}{\rm{ + }}...\\
    =& w_{v1}\sum_{k=0}^{i-1} w_{v2}^{k}\,
       \frac{p_{\,i-k}-p_{\,i-k-1}}{T},\\
{a_i} =& {w_{a1}}\frac{{{p_i} - 2{p_{i - 1}} + {p_{i - 2}}}}{{{T^2}}} + {w_{a2}}{a_{i - 1}}\\
    =& {w_{a1}}\frac{{{p_i} - 2{p_{i - 1}} + {p_{i - 2}}}}{{{T^2}}}+ {w_{a1}}{w_{a2}}\frac{{{p_{i - 1}} - 2{p_{i - 2}} + {p_{i - 3}}}}{{{T^2}}} \\
    +& {w_{a1}}w_{a2}^{\rm{2}}\frac{{{p_{i - 2}} - 2{p_{i - 3}} + {p_{i - 4}}}}{{{T^2}}}{\rm{ + }}...\\
    =& w_{a1}\sum_{k=0}^{i-1} w_{a2}^{k}\,
        \frac{p_{\,i-k}-2p_{\,i-k-1}+p_{\,i-k-2}}{T^{2}} .
\end{aligned}
\end{equation}

\noindent
Given \(p_i,v_i,a_i\), an \(n\)-step-ahead position prediction follows from kinematics:

\begin{equation}
\label{1_7}
p_{i+n}=p_i+v_i\,nT+\tfrac12 a_i\,n^{2}T^{2}.
\end{equation}

\noindent
Substituting~\eqref{1_6} into~\eqref{1_7} yields a weighted finite-difference expansion

\begin{equation}
\label{1_8}
\begin{aligned}
p_{i+n} &=\, p_i + nTw_{v1}\sum_{k=0}^{i-1} w_{v2}^{k} \frac{p_{\,i-k}-p_{\,i-k-1}}{T}\\
&+\tfrac12 n^{2}T^{2} w_{a1}\sum_{k=0}^{i-1} w_{a2}^{k}\frac{p_{\,i-k}-2p_{\,i-k-1}+p_{\,i-k-2}}{T^{2}} = \sum_{k=0}^{i} w_k p_k,
\end{aligned}
\end{equation}

\noindent
Under model~\eqref{1_4}, long-term prediction ultimately reduces to a weighted sum of past positions, an intrinsic limitation when the target executes nonlinear manoeuvres.  To validate the potential of position‐only estimated states, we construct the corresponding state–space models.

We begin with the \emph{two–position estimator} (E2P), based on  
\[
p_{i+1}=p_i+(p_i-p_{i-1}),
\]
which yields
\begin{equation}
\label{eq:E2P}
\begin{aligned}
x_{i+1} &=
\begin{bmatrix}
2 & -1\\
1 &  0
\end{bmatrix}x_i +
\begin{bmatrix}
1&0\\[2pt]
0&1
\end{bmatrix}u_i, 
&
z_i &=
\begin{bmatrix}
1&0
\end{bmatrix}x_i + v_i,
\end{aligned}
\end{equation}
with \(x_i=[p_i,p_{i-1}]^{\mathsf T}\).

\medskip
By extending the position history, we obtain higher‐order variants.  Defining  
\(x_i=[p_i,p_{i-1},p_{i-2}]^{\mathsf T}\) gives the \emph{three–position estimator} (E3P),  
and \(x_i=[p_i,p_{i-1},p_{i-2},p_{i-3}]^{\mathsf T}\) yields the \emph{four–position estimator} (E4P):
\begin{equation}
\label{eq:E3P,E4P}
\begin{aligned}
p_{i+1}&=p_i+\tfrac12(p_i-p_{i-1})+\tfrac12(p_{i-1}-p_{i-2}),\\
p_{i+1}&=p_i+\tfrac13(p_i-p_{i-1})+\tfrac13(p_{i-1}-p_{i-2})
                     +\tfrac13(p_{i-2}-p_{i-3}).
\end{aligned}
\end{equation}
A \emph{variable–weight four–position estimator} (E4PVW) further refines the weights:
\begin{equation}
\label{eq:E4PVW}
p_{i+1}
= p_i
+ \frac{3(p_i-p_{i-1})}{6}
+ \frac{2(p_{i-1}-p_{i-2})}{6}
+ \frac{(p_{i-2}-p_{i-3})}{6}.
\end{equation}

\medskip
For even greater flexibility, the weights may be \emph{learned} from data.  The offline \emph{four–position estimator with regressed weights} (E4PRW) uses
\begin{equation}
\label{eq:E4PRW}
p_{i+1}
= 1.2668\,p_i
- 0.0152\,p_{i-1}
+ 0.0103\,p_{i-2}
- 0.2618\,p_{i-3},
\end{equation}
while its online counterpart (E4PTRW) updates these coefficients at each step using the most recent 50 samples.

\medskip
Simulation results in Figs.~\ref{fig:pos_pred} and~\ref{fig:acc_err} show that all position‐stack estimators outperform classical Kalman filters built on  
\([p_i]\), \([p_i,v_i]\), \([p_i,v_i,a_i]\), and \([p_i,v_i,a_i,\dot a_i]\) (the latter including jerk \(\dot a_i\)).  
Accuracy increases with longer stacks (E3P, E4P) and peaks for variants with adaptive or regressed weights (E4PVW, E4PRW, E4PTRW), with E4PRW notably narrowing the error band and E4PTRW further enhancing adaptability.

\begin{figure}[!t]
  \centering
  \includegraphics[width=4in]{fig/fig1_1.eps}
  \caption{Position prediction obtained with different estimators.}
  \label{fig:pos_pred}
\end{figure}

\begin{figure}[!t]
  \centering
  \includegraphics[width=4in]{fig/fig1_2.eps}
  \caption{Accumulated prediction error for the same estimators.}
  \label{fig:acc_err}
\end{figure}

\medskip
Despite these gains, embedding a dedicated linear‐regression step in each prediction is conceptually inelegant and risks overfitting when the target’s motion pattern changes abruptly.  A more principled solution is to regard the regression coefficients themselves as \emph{latent states}, updating them in real time alongside the kinematic variables.  Accordingly, we extend the state vector to include not only these coefficients but, when appropriate, the full set of weights of a neural network approximation of the target dynamics.  These augmented states are then estimated online using a neural network state–space model.

\section{Neural Network State‐Space Model}\label{sec3}

Based on the concept of treating weights as estimated states, a new state-space model to achieve state estimation for maneuverable targets is introduced as \eqref{3_1} and Figs.~\ref{fig:NNSSM}.

\begin{equation}
\begin{aligned}
{x_{i + 1}} &= {f_i}({x_i},{u_i}) = {f_i}({\left[ {{p_i},...,{p_{i-a+1}},...,{p_{i-a-b+2}},{w_1},...,{w_c}} \right]^T},{u_i})\\
 &= \left[ {{p_{i + 1}},{p_i},...,{p_{i-a-b+3}},{w_1},...,{w_c}} \right]^T + {u_i}\\
{z_i} &= {h_i}({x_i},{v_i}) = {p_i} + {v_i}
\end{aligned}
\label{3_1}
\end{equation}

\begin{figure}[!t]
  \centering
  \includegraphics[width=4in]{fig/fig3_1.png}
  \caption{Neural network state‐space model.}
  \label{fig:NNSSM}
\end{figure}

\section{This is an example for first level head---section head}\label{sec3}

\subsection{This is an example for second level head---subsection head}\label{subsec2}

\subsubsection{This is an example for third level head---subsubsection head}\label{subsubsec2}

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. 

\section{Equations}\label{sec4}

Equations in \LaTeX\ can either be inline or on-a-line by itself (``display equations''). For
inline equations use the \verb+$...$+ commands. E.g.: The equation
$H\psi = E \psi$ is written via the command \verb+$H \psi = E \psi$+.

For display equations (with auto generated equation numbers)
one can use the equation or align environments:
\begin{equation}
\|\tilde{X}(k)\|^2 \leq\frac{\sum\limits_{i=1}^{p}\left\|\tilde{Y}_i(k)\right\|^2+\sum\limits_{j=1}^{q}\left\|\tilde{Z}_j(k)\right\|^2 }{p+q}.\label{eq1}
\end{equation}
where,
\begin{align}
D_\mu &=  \partial_\mu - ig \frac{\lambda^a}{2} A^a_\mu \nonumber \\
F^a_{\mu\nu} &= \partial_\mu A^a_\nu - \partial_\nu A^a_\mu + g f^{abc} A^b_\mu A^a_\nu \label{eq2}
\end{align}
Notice the use of \verb+\nonumber+ in the align environment at the end
of each line, except the last, so as not to produce equation numbers on
lines where no equation numbers are required. The \verb+\label{}+ command
should only be used at the last line of an align environment where
\verb+\nonumber+ is not used.
\begin{equation}
Y_\infty = \left( \frac{m}{\textrm{GeV}} \right)^{-3}
    \left[ 1 + \frac{3 \ln(m/\textrm{GeV})}{15}
    + \frac{\ln(c_2/5)}{15} \right]
\end{equation}
The class file also supports the use of \verb+\mathbb{}+, \verb+\mathscr{}+ and
\verb+\mathcal{}+ commands. As such \verb+\mathbb{R}+, \verb+\mathscr{R}+
and \verb+\mathcal{R}+ produces $\mathbb{R}$, $\mathscr{R}$ and $\mathcal{R}$
respectively (refer Subsubsection~\ref{subsubsec2}).

\section{Tables}\label{sec5}

Tables can be inserted via the normal table and tabular environment. To put
footnotes inside tables you should use \verb+\footnotetext[]{...}+ tag.
The footnote appears just below the table itself (refer Tables~\ref{tab1} and \ref{tab2}). 
For the corresponding footnotemark use \verb+\footnotemark[...]+

\begin{table}[h]
\caption{Caption text}\label{tab1}%
\begin{tabular}{@{}llll@{}}
\toprule
Column 1 & Column 2  & Column 3 & Column 4\\
\midrule
row 1    & data 1   & data 2  & data 3  \\
row 2    & data 4   & data 5\footnotemark[1]  & data 6  \\
row 3    & data 7   & data 8  & data 9\footnotemark[2]  \\
\botrule
\end{tabular}
\footnotetext{Source: This is an example of table footnote. This is an example of table footnote.}
\footnotetext[1]{Example for a first table footnote. This is an example of table footnote.}
\footnotetext[2]{Example for a second table footnote. This is an example of table footnote.}
\end{table}

\noindent
The input format for the above table is as follows:

%%=============================================%%
%% For presentation purpose, we have included  %%
%% \bigskip command. Please ignore this.       %%
%%=============================================%%
\bigskip
\begin{verbatim}
\begin{table}[<placement-specifier>]
\caption{<table-caption>}\label{<table-label>}%
\begin{tabular}{@{}llll@{}}
\toprule
Column 1 & Column 2 & Column 3 & Column 4\\
\midrule
row 1 & data 1 & data 2	 & data 3 \\
row 2 & data 4 & data 5\footnotemark[1] & data 6 \\
row 3 & data 7 & data 8	 & data 9\footnotemark[2]\\
\botrule
\end{tabular}
\footnotetext{Source: This is an example of table footnote. 
This is an example of table footnote.}
\footnotetext[1]{Example for a first table footnote.
This is an example of table footnote.}
\footnotetext[2]{Example for a second table footnote. 
This is an example of table footnote.}
\end{table}
\end{verbatim}
\bigskip
%%=============================================%%
%% For presentation purpose, we have included  %%
%% \bigskip command. Please ignore this.       %%
%%=============================================%%

\begin{table}[h]
\caption{Example of a lengthy table which is set to full textwidth}\label{tab2}
\begin{tabular*}{\textwidth}{@{\extracolsep\fill}lcccccc}
\toprule%
& \multicolumn{3}{@{}c@{}}{Element 1\footnotemark[1]} & \multicolumn{3}{@{}c@{}}{Element 2\footnotemark[2]} \\\cmidrule{2-4}\cmidrule{5-7}%
Project & Energy & $\sigma_{calc}$ & $\sigma_{expt}$ & Energy & $\sigma_{calc}$ & $\sigma_{expt}$ \\
\midrule
Element 3  & 990 A & 1168 & $1547\pm12$ & 780 A & 1166 & $1239\pm100$\\
Element 4  & 500 A & 961  & $922\pm10$  & 900 A & 1268 & $1092\pm40$\\
\botrule
\end{tabular*}
\footnotetext{Note: This is an example of table footnote. This is an example of table footnote this is an example of table footnote this is an example of~table footnote this is an example of table footnote.}
\footnotetext[1]{Example for a first table footnote.}
\footnotetext[2]{Example for a second table footnote.}
\end{table}

In case of double column layout, tables which do not fit in single column width should be set to full text width. For this, you need to use \verb+\begin{table*}+ \verb+...+ \verb+\end{table*}+ instead of \verb+\begin{table}+ \verb+...+ \verb+\end{table}+ environment. Lengthy tables which do not fit in textwidth should be set as rotated table. For this, you need to use \verb+\begin{sidewaystable}+ \verb+...+ \verb+\end{sidewaystable}+ instead of \verb+\begin{table*}+ \verb+...+ \verb+\end{table*}+ environment. This environment puts tables rotated to single column width. For tables rotated to double column width, use \verb+\begin{sidewaystable*}+ \verb+...+ \verb+\end{sidewaystable*}+.

\begin{sidewaystable}
\caption{Tables which are too long to fit, should be written using the ``sidewaystable'' environment as shown here}\label{tab3}
\begin{tabular*}{\textheight}{@{\extracolsep\fill}lcccccc}
\toprule%
& \multicolumn{3}{@{}c@{}}{Element 1\footnotemark[1]}& \multicolumn{3}{@{}c@{}}{Element\footnotemark[2]} \\\cmidrule{2-4}\cmidrule{5-7}%
Projectile & Energy	& $\sigma_{calc}$ & $\sigma_{expt}$ & Energy & $\sigma_{calc}$ & $\sigma_{expt}$ \\
\midrule
Element 3 & 990 A & 1168 & $1547\pm12$ & 780 A & 1166 & $1239\pm100$ \\
Element 4 & 500 A & 961  & $922\pm10$  & 900 A & 1268 & $1092\pm40$ \\
Element 5 & 990 A & 1168 & $1547\pm12$ & 780 A & 1166 & $1239\pm100$ \\
Element 6 & 500 A & 961  & $922\pm10$  & 900 A & 1268 & $1092\pm40$ \\
\botrule
\end{tabular*}
\footnotetext{Note: This is an example of table footnote this is an example of table footnote this is an example of table footnote this is an example of~table footnote this is an example of table footnote.}
\footnotetext[1]{This is an example of table footnote.}
\end{sidewaystable}

\section{Figures}\label{sec6}

As per the \LaTeX\ standards you need to use eps images for \LaTeX\ compilation and \verb+pdf/jpg/png+ images for \verb+PDFLaTeX+ compilation. This is one of the major difference between \LaTeX\ and \verb+PDFLaTeX+. Each image should be from a single input .eps/vector image file. Avoid using subfigures. The command for inserting images for \LaTeX\ and \verb+PDFLaTeX+ can be generalized. The package used to insert images in \verb+LaTeX/PDFLaTeX+ is the graphicx package. Figures can be inserted via the normal figure environment as shown in the below example:

%%=============================================%%
%% For presentation purpose, we have included  %%
%% \bigskip command. Please ignore this.       %%
%%=============================================%%
\bigskip
\begin{verbatim}
\begin{figure}[<placement-specifier>]
\centering
\includegraphics{<eps-file>}
\caption{<figure-caption>}\label{<figure-label>}
\end{figure}
\end{verbatim}
\bigskip
%%=============================================%%
%% For presentation purpose, we have included  %%
%% \bigskip command. Please ignore this.       %%
%%=============================================%%

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{fig.eps}
\caption{This is a widefig. This is an example of long caption this is an example of long caption  this is an example of long caption this is an example of long caption}\label{fig1}
\end{figure}

In case of double column layout, the above format puts figure captions/images to single column width. To get spanned images, we need to provide \verb+\begin{figure*}+ \verb+...+ \verb+\end{figure*}+.

For sample purpose, we have included the width of images in the optional argument of \verb+\includegraphics+ tag. Please ignore this. 

\section{Algorithms, Program codes and Listings}\label{sec7}

Packages \verb+algorithm+, \verb+algorithmicx+ and \verb+algpseudocode+ are used for setting algorithms in \LaTeX\ using the format:

%%=============================================%%
%% For presentation purpose, we have included  %%
%% \bigskip command. Please ignore this.       %%
%%=============================================%%
\bigskip
\begin{verbatim}
\begin{algorithm}
\caption{<alg-caption>}\label{<alg-label>}
\begin{algorithmic}[1]
. . .
\end{algorithmic}
\end{algorithm}
\end{verbatim}
\bigskip
%%=============================================%%
%% For presentation purpose, we have included  %%
%% \bigskip command. Please ignore this.       %%
%%=============================================%%

You may refer above listed package documentations for more details before setting \verb+algorithm+ environment. For program codes, the ``verbatim'' package is required and the command to be used is \verb+\begin{verbatim}+ \verb+...+ \verb+\end{verbatim}+. 

Similarly, for \verb+listings+, use the \verb+listings+ package. \verb+\begin{lstlisting}+ \verb+...+ \verb+\end{lstlisting}+ is used to set environments similar to \verb+verbatim+ environment. Refer to the \verb+lstlisting+ package documentation for more details.

A fast exponentiation procedure:

\lstset{texcl=true,basicstyle=\small\sf,commentstyle=\small\rm,mathescape=true,escapeinside={(*}{*)}}
\begin{lstlisting}
begin
  for $i:=1$ to $10$ step $1$ do
      expt($2,i$);  
      newline() od                (*\textrm{Comments will be set flush to the right margin}*)
where
proc expt($x,n$) $\equiv$
  $z:=1$;
  do if $n=0$ then exit fi;
     do if odd($n$) then exit fi;                 
        comment: (*\textrm{This is a comment statement;}*)
        $n:=n/2$; $x:=x*x$ od;
     { $n>0$ };
     $n:=n-1$; $z:=z*x$ od;
  print($z$). 
end
\end{lstlisting}

\begin{algorithm}
\caption{Calculate $y = x^n$}\label{algo1}
\begin{algorithmic}[1]
\Require $n \geq 0 \vee x \neq 0$
\Ensure $y = x^n$ 
\State $y \Leftarrow 1$
\If{$n < 0$}\label{algln2}
        \State $X \Leftarrow 1 / x$
        \State $N \Leftarrow -n$
\Else
        \State $X \Leftarrow x$
        \State $N \Leftarrow n$
\EndIf
\While{$N \neq 0$}
        \If{$N$ is even}
            \State $X \Leftarrow X \times X$
            \State $N \Leftarrow N / 2$
        \Else[$N$ is odd]
            \State $y \Leftarrow y \times X$
            \State $N \Leftarrow N - 1$
        \EndIf
\EndWhile
\end{algorithmic}
\end{algorithm}

%%=============================================%%
%% For presentation purpose, we have included  %%
%% \bigskip command. Please ignore this.       %%
%%=============================================%%
\bigskip
\begin{minipage}{\hsize}%
\lstset{frame=single,framexleftmargin=-1pt,framexrightmargin=-17pt,framesep=12pt,linewidth=0.98\textwidth,language=pascal}% Set your language (you can change the language for each code-block optionally)
%%% Start your code-block
\begin{lstlisting}
for i:=maxint to 0 do
begin
{ do nothing }
end;
Write('Case insensitive ');
Write('Pascal keywords.');
\end{lstlisting}
\end{minipage}

\section{Cross referencing}\label{sec8}

Environments such as figure, table, equation and align can have a label
declared via the \verb+\label{#label}+ command. For figures and table
environments use the \verb+\label{}+ command inside or just
below the \verb+\caption{}+ command. You can then use the
\verb+\ref{#label}+ command to cross-reference them. As an example, consider
the label declared for Figure~\ref{fig1} which is
\verb+\label{fig1}+. To cross-reference it, use the command 
\verb+Figure \ref{fig1}+, for which it comes up as
``Figure~\ref{fig1}''. 

To reference line numbers in an algorithm, consider the label declared for the line number 2 of Algorithm~\ref{algo1} is \verb+\label{algln2}+. To cross-reference it, use the command \verb+\ref{algln2}+ for which it comes up as line~\ref{algln2} of Algorithm~\ref{algo1}.

\subsection{Details on reference citations}\label{subsec7}

Standard \LaTeX\ permits only numerical citations. To support both numerical and author-year citations this template uses \verb+natbib+ \LaTeX\ package. For style guidance please refer to the template user manual.

Here is an example for \verb+\cite{...}+: \cite{bib1}. Another example for \verb+\citep{...}+: \citep{bib2}. For author-year citation mode, \verb+\cite{...}+ prints Jones et al. (1990) and \verb+\citep{...}+ prints (Jones et al., 1990).

All cited bib entries are printed at the end of this article: \cite{bib3}, \cite{bib4}, \cite{bib5}, \cite{bib6}, \cite{bib7}, \cite{bib8}, \cite{bib9}, \cite{bib10}, \cite{bib11}, \cite{bib12} and \cite{bib13}.


\section{Examples for theorem like environments}\label{sec10}

For theorem like environments, we require \verb+amsthm+ package. There are three types of predefined theorem styles exists---\verb+thmstyleone+, \verb+thmstyletwo+ and \verb+thmstylethree+ 

%%=============================================%%
%% For presentation purpose, we have included  %%
%% \bigskip command. Please ignore this.       %%
%%=============================================%%
\bigskip
\begin{tabular}{|l|p{19pc}|}
\hline
\verb+thmstyleone+ & Numbered, theorem head in bold font and theorem text in italic style \\\hline
\verb+thmstyletwo+ & Numbered, theorem head in roman font and theorem text in italic style \\\hline
\verb+thmstylethree+ & Numbered, theorem head in bold font and theorem text in roman style \\\hline
\end{tabular}
\bigskip
%%=============================================%%
%% For presentation purpose, we have included  %%
%% \bigskip command. Please ignore this.       %%
%%=============================================%%

For mathematics journals, theorem styles can be included as shown in the following examples:

\begin{theorem}[Theorem subhead]\label{thm1}
Example theorem text. Example theorem text. Example theorem text. Example theorem text. Example theorem text. 
Example theorem text. Example theorem text. Example theorem text. Example theorem text. Example theorem text. 
Example theorem text. 
\end{theorem}

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text.

\begin{proposition}
Example proposition text. Example proposition text. Example proposition text. Example proposition text. Example proposition text. 
Example proposition text. Example proposition text. Example proposition text. Example proposition text. Example proposition text. 
\end{proposition}

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text.

\begin{example}
Phasellus adipiscing semper elit. Proin fermentum massa
ac quam. Sed diam turpis, molestie vitae, placerat a, molestie nec, leo. Maecenas lacinia. Nam ipsum ligula, eleifend
at, accumsan nec, suscipit a, ipsum. Morbi blandit ligula feugiat magna. Nunc eleifend consequat lorem. 
\end{example}

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text.

\begin{remark}
Phasellus adipiscing semper elit. Proin fermentum massa
ac quam. Sed diam turpis, molestie vitae, placerat a, molestie nec, leo. Maecenas lacinia. Nam ipsum ligula, eleifend
at, accumsan nec, suscipit a, ipsum. Morbi blandit ligula feugiat magna. Nunc eleifend consequat lorem. 
\end{remark}

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text.

\begin{definition}[Definition sub head]
Example definition text. Example definition text. Example definition text. Example definition text. Example definition text. Example definition text. Example definition text. Example definition text. 
\end{definition}

Additionally a predefined ``proof'' environment is available: \verb+\begin{proof}+ \verb+...+ \verb+\end{proof}+. This prints a ``Proof'' head in italic font style and the ``body text'' in roman font style with an open square at the end of each proof environment. 

\begin{proof}
Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. 
\end{proof}

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text.

\begin{proof}[Proof of Theorem~{\upshape\ref{thm1}}]
Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. 
\end{proof}

\noindent
For a quote environment, use \verb+\begin{quote}...\end{quote}+
\begin{quote}
Quoted text example. Aliquam porttitor quam a lacus. Praesent vel arcu ut tortor cursus volutpat. In vitae pede quis diam bibendum placerat. Fusce elementum
convallis neque. Sed dolor orci, scelerisque ac, dapibus nec, ultricies ut, mi. Duis nec dui quis leo sagittis commodo.
\end{quote}

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text (refer Figure~\ref{fig1}). Sample body text. Sample body text. Sample body text (refer Table~\ref{tab3}). 

\section{Methods}\label{sec11}

Topical subheadings are allowed. Authors must ensure that their Methods section includes adequate experimental and characterization data necessary for others in the field to reproduce their work. Authors are encouraged to include RIIDs where appropriate. 

\textbf{Ethical approval declarations} (only required where applicable) Any article reporting experiment/s carried out on (i)~live vertebrate (or higher invertebrates), (ii)~humans or (iii)~human samples must include an unambiguous statement within the methods section that meets the following requirements: 

\begin{enumerate}[1.]
\item Approval: a statement which confirms that all experimental protocols were approved by a named institutional and/or licensing committee. Please identify the approving body in the methods section

\item Accordance: a statement explicitly saying that the methods were carried out in accordance with the relevant guidelines and regulations

\item Informed consent (for experiments involving humans or human tissue samples): include a statement confirming that informed consent was obtained from all participants and/or their legal guardian/s
\end{enumerate}

If your manuscript includes potentially identifying patient/participant information, or if it describes human transplantation research, or if it reports results of a clinical trial then  additional information will be required. Please visit (\url{https://www.nature.com/nature-research/editorial-policies}) for Nature Portfolio journals, (\url{https://www.springer.com/gp/authors-editors/journal-author/journal-author-helpdesk/publishing-ethics/14214}) for Springer Nature journals, or (\url{https://www.biomedcentral.com/getpublished/editorial-policies\#ethics+and+consent}) for BMC.

\section{Discussion}\label{sec12}

Discussions should be brief and focused. In some disciplines use of Discussion or `Conclusion' is interchangeable. It is not mandatory to use both. Some journals prefer a section `Results and Discussion' followed by a section `Conclusion'. Please refer to Journal-level guidance for any specific requirements. 

\section{Conclusion}\label{sec13}

Conclusions may be used to restate your hypothesis or research question, restate your major findings, explain the relevance and the added value of your work, highlight any limitations of your study, describe future directions for research and recommendations. 

In some disciplines use of Discussion or 'Conclusion' is interchangeable. It is not mandatory to use both. Please refer to Journal-level guidance for any specific requirements. 

\backmatter

\bmhead{Supplementary information}

If your article has accompanying supplementary file/s please state so here. 

Authors reporting data from electrophoretic gels and blots should supply the full unprocessed scans for key as part of their Supplementary information. This may be requested by the editorial team/s if it is missing.

Please refer to Journal-level guidance for any specific requirements.

\bmhead{Acknowledgements}

Acknowledgements are not compulsory. Where included they should be brief. Grant or contribution numbers may be acknowledged.

Please refer to Journal-level guidance for any specific requirements.

\section*{Declarations}

Some journals require declarations to be submitted in a standardised format. Please check the Instructions for Authors of the journal to which you are submitting to see if you need to complete this section. If yes, your manuscript must contain the following sections under the heading `Declarations':

\begin{itemize}
\item Funding
\item Conflict of interest/Competing interests (check journal-specific guidelines for which heading to use)
\item Ethics approval and consent to participate
\item Consent for publication
\item Data availability 
\item Materials availability
\item Code availability 
\item Author contribution
\end{itemize}

\noindent
If any of the sections are not relevant to your manuscript, please include the heading and write `Not applicable' for that section. 

%%===================================================%%
%% For presentation purpose, we have included        %%
%% \bigskip command. Please ignore this.             %%
%%===================================================%%
\bigskip
\begin{flushleft}%
Editorial Policies for:

\bigskip\noindent
Springer journals and proceedings: \url{https://www.springer.com/gp/editorial-policies}

\bigskip\noindent
Nature Portfolio journals: \url{https://www.nature.com/nature-research/editorial-policies}

\bigskip\noindent
\textit{Scientific Reports}: \url{https://www.nature.com/srep/journal-policies/editorial-policies}

\bigskip\noindent
BMC journals: \url{https://www.biomedcentral.com/getpublished/editorial-policies}
\end{flushleft}

\begin{appendices}

\section{Section title of first appendix}\label{secA1}

An appendix contains supplementary information that is not an essential part of the text itself but which may be helpful in providing a more comprehensive understanding of the research problem or it is information that is too cumbersome to be included in the body of the paper.

%%=============================================%%
%% For submissions to Nature Portfolio Journals %%
%% please use the heading ``Extended Data''.   %%
%%=============================================%%

%%=============================================================%%
%% Sample for another appendix section			       %%
%%=============================================================%%

%% \section{Example of another appendix section}\label{secA2}%
%% Appendices may be used for helpful, supporting or essential material that would otherwise 
%% clutter, break up or be distracting to the text. Appendices can consist of sections, figures, 
%% tables and equations etc.

\end{appendices}

%%===========================================================================================%%
%% If you are submitting to one of the Nature Portfolio journals, using the eJP submission   %%
%% system, please include the references within the manuscript file itself. You may do this  %%
%% by copying the reference list from your .bbl file, paste it into the main manuscript .tex %%
%% file, and delete the associated \verb+\bibliography+ commands.                            %%
%%===========================================================================================%%

\bibliography{sn-bibliography}% common bib file
%% if required, the content of .bbl file can be included here once bbl is generated
%%\input sn-article.bbl


\end{document}
